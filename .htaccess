# Protect sensitive files
<Files "settings.php">
    Order Allow,Deny
    Deny from all
</Files>

<Files "db.php">
    Order Allow,Deny
    Deny from all
</Files>

<Files "comments.db">
    Order Allow,Deny
    Deny from all
</Files>

# Prevent directory listing
Options -Indexes

# Protect against script injection
<FilesMatch "(?i)\.(php|php3|php4|php5|phtml)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Basic security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
</IfModule>

# Force HTTPS if available
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} !=on
    RewriteCond %{HTTP:X-Forwarded-Proto} !https
    RewriteCond %{HTTP_HOST} !^localhost
    RewriteCond %{REMOTE_ADDR} !^127\.0\.0\.1$
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>
